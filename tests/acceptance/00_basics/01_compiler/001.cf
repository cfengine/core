######################################################
#
#  Issue 375 setup (precursor to actual tickle of bug)
#
#####################################################
body common control
{
      inputs => { "../../default.cf.sub" };
      bundlesequence  => { default("$(this.promise_filename)") };
      version => "1.0";
}

#######################################################

bundle agent init
{
  methods:
      "1" usebundle => dcs_fini($(G.testfile));
      "2" usebundle => dcs_emptyfile("$(G.testfile).SOURCE");
}

#######################################################

bundle agent test
{
   methods:
      "" usebundle => dcs_hardlinkfile("$(G.testfile).SOURCE",
                                       $(G.testfile));
   meta:
     "test_suppress_fail" string => "windows", meta => { "redmine4608" };
}

#######################################################

bundle agent check
{
  methods:
      "" usebundle => dcs_passif_fileexists($(G.testfile),
                                            $(this.promise_filename));
  reports:
    DEBUG::
      "This test should pass as a precursor to a bunch of related failures";
}
