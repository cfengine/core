body common control
{
      inputs => {
                  "../../default.cf.sub",
      };
      bundlesequence  => { default("$(this.promise_filename)") };
      version => "1.0";
}

bundle agent init
{
  commands:
      # Ensure there is a file with a date in the future beyond 2038
      "/usr/bin/touch -t 204201010000 $(this.promise_filename).sub.file-with-mtime-after-2038";
}

bundle agent test
{
  meta:
      "description" string => "Test that the agent does not crash on dates after 2038.";

}

bundle agent check
{
  meta:
      "test_skip_unsupported" string => "!64_bit";

  classes:
      "ok" expression => "class_defined_from_included_bundle";
  methods:
      "" usebundle => dcs_passif_output(".*Pass.*", "", "$(sys.cf_agent) -Kf $(this.promise_filename).sub", $(this.promise_filename));

}
