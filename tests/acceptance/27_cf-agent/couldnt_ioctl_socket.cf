body common control
{
  inputs => { "../default.cf.sub" };
  bundlesequence => { default("$(this.promise_filename)") };
}

bundle agent test
{
  commands:
"/usr/bin/which gdb";
# TODO is there something I can use instead of promise_dirname to get relative paths here?
    "$(this.promise_dirname)/../../../libtool --mode=execute /usr/bin/gdb -x $(this.promise_dirname)/couldnt_ioctl_socket.gdb --args $(this.promise_dirname)/../../../cf-serverd/cf-serverd --no-lock --no-fork --debug --file $(this.promise_dirname)/couldnt_ioctl_socket.cf.sub"
      classes => keptcode;
}

bundle agent check
{
  methods:
    "pass" usebundle => dcs_passif("ok", "$(this.promise_filename)");
}

body classes keptcode
{
  kept_returncodes => { "1" };
  promise_kept => { "ok" };
}
